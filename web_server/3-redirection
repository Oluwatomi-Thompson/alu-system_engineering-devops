#!/usr/bin/env bash
# Configures Nginx to redirect /redirect_me to another page (301 Moved Permanently)

# Update and install Nginx
apt-get update -y
apt-get install -y nginx

# Create index page
echo 'Holberton School for the win!' > /var/www/html/index.nginx-debian.html

# Add redirect configuration using sed
# Check if redirect already exists, if not add it
if ! grep -q "location /redirect_me" /etc/nginx/sites-available/default; then
    sed -i '/server_name _;/a \\n\tlocation /redirect_me {\n\t\treturn 301 https://www.youtube.com/watch?v=QH2-TGUlwu4;\n\t}\n' /etc/nginx/sites-available/default
fi

# Test Nginx configuration
nginx -t

# Restart Nginx
service nginx restart